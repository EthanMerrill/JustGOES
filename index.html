<!DOCTYPE html>
<html>
<!-- local stylesheet -->
<link rel="stylesheet" href="style.css">

<head>
    <!-- Refresh the page every 10 minutes -->
    <meta http-equiv="refresh" content="600">
</head>

<body>
    <div class=page-container>
        <div class="img-container">
            <img id="satImage" src="https://cdn.star.nesdis.noaa.gov/GOES16/ABI/FD/GEOCOLOR/20203271600_GOES16-ABI-FD-GEOCOLOR-1808x1808.jpg">
            <div class="noaa-cover"></div>
            <div class='date-cover'></div>
        </div>
    </div>

</body>

</html>
<script>
    // Create date object
    var now = new Date();

    var utc_timestamp = Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(),
        now.getUTCHours(), now.getUTCMinutes(), now.getUTCSeconds(), now.getUTCMilliseconds());

    oldminutes = now.getUTCMinutes()

    now.setUTCMinutes(Math.floor((oldminutes - 20) / 10) * 10)

    var start = new Date(now.getFullYear(), 0, 0);
    var diff = now - start;
    var oneDay = 1000 * 60 * 60 * 24;
    var day = Math.floor(diff / oneDay);

    if (now.getUTCMinutes() == 0) {
        goesTimeMinutes = "00"
    } else {
        goesTimeMinutes = now.getUTCMinutes().toString()
    }
    goesTimeObject = (now.getUTCFullYear().toString() + day.toString() + now.getUTCHours().toString() + goesTimeMinutes)

    // Find the smallest image size to get given the display resolution
    imageSizes = [339, 678, 1808, 5424, 10848]
        // https://forum.freecodecamp.org/t/freecodecamp-challenge-guide-where-do-i-belong/16094
    function getIndexToIns(arr, num) {
        arr.sort(function(a, b) {
            return a - b;
        });

        var i = 0;
        while (num > arr[i]) {
            i++;
        }

        return i;
    }

    imageSize = (imageSizes[getIndexToIns(imageSizes, window.innerHeight)])

    goesSrcString = `https://cdn.star.nesdis.noaa.gov/GOES16/ABI/FD/GEOCOLOR/${goesTimeObject}_GOES16-ABI-FD-GEOCOLOR-${imageSize}x${imageSize}.jpg`
    satImage = document.getElementById("satImage").src = goesSrcString
</script>